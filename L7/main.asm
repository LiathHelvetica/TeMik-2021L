ORG 0000H
	LJMP INIT

; F0 - stan w poprzednim ticku
; P1.0 - zadany pin

ORG 0200H
INIT:
	TLOW EQU 0F2H
	THIGH EQU 0FFH
	COUNTER EQU 030H
	MOV COUNTER, 00H
	MOV DPTR, #00H
	CLR F0
	JNB P1.0, SKIP
	SETB F0
SKIP:	MOV TL0, #TLOW
	MOV TH0, #THIGH			; czas timera
	SETB TR0			; zacznij liczyć
	SETB ET0			; maska timera
	SETB EA				; maska główna
MAIN:	LJMP MAIN			; mądry program

ORG 0000Bh
	LJMP TIMI

ORG 0300H
TIMI:	MOV TL0, #TLOW
	MOV TH0, #THIGH
	INC COUNTER
	JB F0, F0BIT
F0CLR:	JB P1.0, CHNG
	RETI

F0BIT:	JNB P1.0, CHNG
	RETI

CHNG:	CPL F0
	MOV A, COUNTER
	MOVX @DPTR, A
	MOV COUNTER, #00H
	INC DPTR
	RETI

END